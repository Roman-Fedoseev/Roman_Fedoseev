# Предсказание ценовых интервалов (p05–p95)  
## с оптимизацией метрики IoU (Intersection over Union)

---

## Постановка задачи

Необходимо предсказать **ценовой интервал** для товара — **5-й и 95-й квантили цены**, оптимизируя качество **не по MAE**, а **напрямую по метрике IoU** между истинным и предсказанным интервалами.

---

## Ключевая идея решения

Решение строится на трех фундаментальных принципах:

1. **Раздельное моделирование нижней и верхней границы**  
   - отдельная модель для `p05`
   - отдельная модель для `p95`

2. **Продвинутый feature engineering**, основанный **исключительно на train-данных**  
   (строгая защита от data leakage)

3. **Калибровка ширины интервала** на валидации  
   с прямой оптимизацией **IoU**, вдохновленная идеями *Conformal Prediction*

---

## Архитектура решения
Train \
├── Feature Engineering \
│ \
├── Model_low (p05) \
│ └── Optuna → best params \
│ \
├── Model_high (p95) \
│ └── Optuna → best params \
│ \
├── Calibration (validation) \
│ └── Grid search по (q_low, q_high) \
│ └── max IoU \
│ \
└── Retrain on full train \
└── Apply calibrated intervals to test \

---
